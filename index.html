<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-7-4 ì ìˆ˜ ê³„ì‚°ê¸° (2025ë…„) - ì •ë³´ ìˆ˜ì§‘</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; min-height: 100vh; }
        .container { max-width: 600px; margin: 0 auto; background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
        h1 { color: #333; text-align: center; margin-bottom: 10px; font-size: 24px; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-size: 14px; }
        .section { margin-bottom: 25px; padding: 20px; background: #f8f9fa; border-radius: 10px; }
        .section-title { font-size: 18px; color: #667eea; margin-bottom: 15px; font-weight: bold; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #333; font-weight: 500; font-size: 14px; }
        input[type="text"], input[type="tel"], input[type="number"], select { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; transition: border-color 0.3s; }
        input:focus, select:focus { outline: none; border-color: #667eea; }

        /* ì²´í¬ë°•ìŠ¤ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
        .checkbox-group { display: flex; align-items: center; cursor: pointer; padding: 5px 0; }
        .checkbox-group input[type="checkbox"] { width: 20px; height: 20px; margin-right: 10px; cursor: pointer; }
        .checkbox-group label { margin-bottom: 0; cursor: pointer; user-select: none; }

        button { width: 100%; padding: 15px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; cursor: pointer; transition: all 0.3s; margin-top: 20px; }
        button:hover { transform: scale(1.02); }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .result { margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; color: white; text-align: center; display: none; }
        .result.show { display: block; }
        .result h2 { margin-bottom: 15px; font-size: 22px; }
        .score { font-size: 48px; font-weight: bold; margin: 20px 0; }
        #calculatorSection { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <!-- ê°œì¸ì •ë³´ ìˆ˜ì§‘ ì„¹ì…˜ -->
        <div id="userInfoSection">
            <h1>ğŸ‡°ğŸ‡· E-7-4 ì ìˆ˜ ê³„ì‚°ê¸°</h1>
            <div class="subtitle">ë¬´ë£Œ ê³„ì‚°ê¸° ì‚¬ìš©ì„ ìœ„í•´ ì„±í•¨ê³¼ ì—°ë½ì²˜ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>
            <form id="userForm">
                <div class="section">
                    <div class="input-group">
                        <label for="name">ì„±í•¨</label>
                        <input type="text" id="name" name="name" placeholder="í™ê¸¸ë™" required>
                    </div>
                    <div class="input-group">
                        <label for="phone">ì—°ë½ì²˜</label>
                        <input type="tel" id="phone" name="phone" placeholder="010-1234-5678" required>
                    </div>
                    <!-- ìˆ˜ì •ëœ ì²´í¬ë°•ìŠ¤ ë¶€ë¶„: onclick ì´ë²¤íŠ¸ ì œê±° -->
                    <div class="input-group checkbox-group">
                        <input type="checkbox" id="agree" required>
                        <label for="agree">ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤.</label>
                    </div>
                </div>
                <button type="submit" id="submitUserInfo">ê³„ì‚°ê¸° ì‚¬ìš©í•˜ê¸°</button>
            </form>
        </div>

        <!-- ì ìˆ˜ ê³„ì‚°ê¸° ì„¹ì…˜ (ì´ˆê¸° ìˆ¨ê¹€) -->
        <div id="calculatorSection">
             <h1>ğŸ‡°ğŸ‡· E-7-4 ì ìˆ˜ ê³„ì‚°ê¸°</h1>
             <div class="subtitle">2025ë…„ ìˆ™ë ¨ê¸°ëŠ¥ì¸ë ¥ ì ìˆ˜ì œ ìµœì‹  ê¸°ì¤€</div>
             <form id="calculatorForm">
                <div class="section">
                    <div class="section-title">ğŸ“‹ ê¸°ë³¸í•­ëª©</div>
                    <div class="input-group"><label>ì—°ê°„ ì†Œë“ (ë§Œì›)</label><input type="number" id="income" placeholder="ì˜ˆ: 3000" required></div>
                    <div class="input-group"><label>í•™ë ¥</label><select id="education" required><option value="">ì„ íƒí•˜ì„¸ìš”</option><option value="0">ê³ ì¡¸ ì´í•˜</option><option value="1">ì „ë¬¸í•™ì‚¬</option><option value="2">í•™ì‚¬</option><option value="3">ì„ì‚¬ ì´ìƒ</option></select></div>
                    <div class="input-group"><label>ë§Œ ë‚˜ì´</label><input type="number" id="age" placeholder="ì˜ˆ: 32" required></div>
                    <div class="input-group"><label>í•œêµ­ì–´ ëŠ¥ë ¥ ì‹œí—˜ ì¢…ë¥˜</label><select id="koreanType" required><option value="">ì„ íƒí•˜ì„¸ìš”</option><option value="topik">TOPIK</option><option value="kiip">KIIP</option></select></div>
                    <div class="input-group"><label>í•œêµ­ì–´ ëŠ¥ë ¥ ë“±ê¸‰/ë‹¨ê³„</label><input type="number" id="koreanLevel" min="1" max="6" placeholder="1~6" required></div>
                </div>
                <div class="section">
                    <div class="section-title">âœ… ì„ íƒí•­ëª©</div>
                    <div class="input-group"><label>ë™ì¼ ì—…ì²´ ì—°ì† ê·¼ë¬´ ê¸°ê°„ (ë…„)</label><input type="number" id="service" value="0"></div>
                    <div class="input-group"><label>ë³¸ì¸ ëª…ì˜ ìˆœìì‚° (ë§Œì›)</label><input type="number" id="assets" value="0"></div>
                    <div class="input-group checkbox-group"><input type="checkbox" id="studyExp"><label for="studyExp">êµ­ë‚´ ìœ í•™/ì—°ìˆ˜ ê²½í—˜ ìˆìŒ</label></div>
                </div>
                <div class="section">
                    <div class="section-title">â• ê°€ì í•­ëª©</div>
                    <div class="input-group checkbox-group"><input type="checkbox" id="certificate"><label for="certificate">ê´€ë ¨ ë¶„ì•¼ êµ­ê°€ê¸°ìˆ ìê²©ì¦</label></div>
                    <div class="input-group"><label>ì¶”ì²œì„œ</label><select id="recommendation"><option value="0">ì—†ìŒ</option><option value="1">ê´€ê³„ ì¤‘ì•™ë¶€ì²˜</option><option value="2">ê´‘ì—­ì§€ìì²´</option></select></div>
                    <div class="input-group checkbox-group"><input type="checkbox" id="rural"><label for="rural">ìë©´ì§€ì—­ 2ë…„ ì´ìƒ ê·¼ë¬´</label></div>
                    <div class="input-group"><label>ì‚¬íšŒë´‰ì‚¬ í™œë™ ì‹œê°„</label><input type="number" id="volunteer" value="0"></div>
                    <div class="input-group"><label>ì—°ê°„ ì†Œë“ì„¸ ë‚©ë¶€ì•¡ (ë§Œì›)</label><input type="number" id="tax" value="0"></div>
                </div>
                <div class="section">
                    <div class="section-title">â– ê°ì í•­ëª©</div>
                    <div class="input-group"><label>ì¶œì…êµ­ê´€ë¦¬ë²• ìœ„ë°˜ íšŸìˆ˜</label><input type="number" id="immigration" value="0"></div>
                    <div class="input-group"><label>êµ­ë‚´ë²• ìœ„ë°˜ íšŸìˆ˜</label><input type="number" id="criminal" value="0"></div>
                </div>
                <button type="submit">ì ìˆ˜ ê³„ì‚°í•˜ê¸°</button>
             </form>
             <div class="result" id="result">
                <h2>ê³„ì‚° ê²°ê³¼</h2>
                <div class="score" id="totalScore">0ì </div>
                <div class="result-detail"><div>ê¸°ë³¸í•­ëª© ì ìˆ˜: <span id="basicScore">0</span>ì </div></div>
                <div class="result-status" id="status"></div>
             </div>
        </div>
    </div>

    <script>
        // ê°œì¸ì •ë³´ í¼ ì œì¶œ ì²˜ë¦¬
        const userForm = document.getElementById('userForm');
        const submitButton = document.getElementById('submitUserInfo');

        userForm.addEventListener('submit', function(e) {
            e.preventDefault();

            // ì²´í¬ë°•ìŠ¤ í™•ì¸ (required ì†ì„±ì´ ìˆì§€ë§Œ í•œ ë²ˆ ë” ëª…ì‹œì  í™•ì¸)
            if (!document.getElementById('agree').checked) {
                alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•´ì£¼ì„¸ìš”.');
                return;
            }

            submitButton.disabled = true;
            submitButton.textContent = 'ì „ì†¡ ì¤‘...';

            // Google App Script URLì„ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
            const scriptURL = 'https://script.google.com/macros/s/AKfycbxe61tcSiDfhmwTz06z6ARMPMpqNDWkor1F91ksXC9lMjXGJiSISH32MyfY6dhGbhA/exec';
 
            const formData = new FormData(userForm);

            fetch(scriptURL, { method: 'POST', body: formData })
                .then(response => {
                    console.log('Success!', response);
                    document.getElementById('userInfoSection').style.display = 'none';
                    document.getElementById('calculatorSection').style.display = 'block';
                    // í™”ë©´ ìµœìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤ ì´ë™
                    window.scrollTo(0, 0);
                })
                .catch(error => {
                    console.error('Error!', error.message);
                    alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜ ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.");
                    submitButton.disabled = false;
                    submitButton.textContent = 'ê³„ì‚°ê¸° ì‚¬ìš©í•˜ê¸°';
                });
        });

        // ê³„ì‚°ê¸° ë¡œì§
        document.getElementById('calculatorForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const income = parseFloat(document.getElementById('income').value);
            const education = parseInt(document.getElementById('education').value);
            const age = parseInt(document.getElementById('age').value);
            const koreanType = document.getElementById('koreanType').value;
            const koreanLevel = parseInt(document.getElementById('koreanLevel').value);
            const service = parseFloat(document.getElementById('service').value) || 0;
            const assets = parseFloat(document.getElementById('assets').value) || 0;
            const studyExp = document.getElementById('studyExp').checked;
            const certificate = document.getElementById('certificate').checked;
            const recommendation = parseInt(document.getElementById('recommendation').value);
            const rural = document.getElementById('rural').checked;
            const volunteer = parseFloat(document.getElementById('volunteer').value) || 0;
            const tax = parseFloat(document.getElementById('tax').value) || 0;
            const immigration = parseInt(document.getElementById('immigration').value) || 0;
            const criminal = parseInt(document.getElementById('criminal').value) || 0;
            let score = 0, basicScore = 0;
            if (income >= 3300) basicScore += 60; else if (income >= 3000) basicScore += 50; else if (income >= 2600) basicScore += 40; else if (income >= 2300) basicScore += 30; else if (income >= 2000) basicScore += 20; else basicScore += 10;
            if (education === 3) basicScore += 20; else if (education === 2) basicScore += 15; else if (education === 1) basicScore += 10; else basicScore += 5;
            if (age >= 20 && age <= 29) basicScore += 15; else if (age >= 30 && age <= 34) basicScore += 12; else if (age >= 35 && age <= 39) basicScore += 10; else if (age >= 40 && age <= 44) basicScore += 8; else if (age >= 45 && age <= 49) basicScore += 5;
            if (koreanType === 'topik') { if (koreanLevel >= 5) basicScore += 20; else if (koreanLevel === 4) basicScore += 15; else if (koreanLevel === 3) basicScore += 10; else if (koreanLevel === 2) basicScore += 5; } else if (koreanType === 'kiip') { if (koreanLevel >= 5) basicScore += 20; else if (koreanLevel === 4) basicScore += 15; else if (koreanLevel === 3) basicScore += 10; else if (koreanLevel >= 1) basicScore += 5; }
            score = basicScore;
            if (service >= 6) score += 15; else if (service >= 4) score += 10; else if (service >= 2) score += 5;
            if (assets >= 10000) score += 25; else if (assets >= 8000) score += 20; else if (assets >= 5000) score += 15; else if (assets >= 2000) score += 10;
            if (studyExp) score += 15;
            if (certificate) score += 20;
            if (recommendation === 1) score += 20; else if (recommendation === 2) score += 10;
            if (rural) score += 10;
            if (volunteer >= 200) score += 5;
            if (tax >= 400) score += 5;
            score -= (immigration * 5); score -= (criminal * 10);
            document.getElementById('totalScore').textContent = score + 'ì ';
            document.getElementById('basicScore').textContent = basicScore;
            const statusDiv = document.getElementById('status');
            if (score >= 200 && basicScore >= 50) { statusDiv.className = 'result-status pass'; statusDiv.textContent = 'âœ… í•©ê²© ê¸°ì¤€ì„ ì¶©ì¡±í•©ë‹ˆë‹¤!'; } else { statusDiv.className = 'result-status fail'; let msg = 'âŒ í•©ê²© ê¸°ì¤€ ë¯¸ë‹¬'; if (score < 200) msg += ' (ì´ì  200ì  ì´ìƒ í•„ìš”)'; if (basicScore < 50) msg += ' (ê¸°ë³¸í•­ëª© 50ì  ì´ìƒ í•„ìš”)'; statusDiv.textContent = msg; }
            document.getElementById('result').classList.add('show');
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>